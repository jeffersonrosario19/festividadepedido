
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cardápio Online - anota aí</title>
  <link href="styles.css" rel="stylesheet" />
</head>
<body>

  <!-- ==================== CABEÇALHO ==================== -->
  <header>
    <h1>Cardápio</h1>
  </header>

  <!-- ==================== SEÇÃO DE PRATOS ==================== -->
  <section>
    <div class="category-title" onclick="toggleGrid('pratos')">Pratos Típicos</div>
    <div id="pratos" class="grid">
      <div class="item"><div class="item-name">Vatapá</div><div class="item-price">R$ 6,00</div></div>
      <div class="item"><div class="item-name">Lasanha</div><div class="item-price">R$ 8,00</div></div>
      <div class="item"><div class="item-name">Churrasco</div><div class="item-price">R$ 12,00</div></div>
      <div class="item"><div class="item-name">Torta Salgada</div><div class="item-price">R$ 6,00</div></div>
      <div class="item"><div class="item-name">Tacacá</div><div class="item-price">R$ 10,00</div></div>
      <div class="item"><div class="item-name">Arroz com galinha</div><div class="item-price">R$ 6,00</div></div>
    </div>
  </section>

  <!-- ==================== SEÇÃO DE BOLOS ==================== -->
  <section>
    <div class="category-title" onclick="toggleGrid('bolos')">Bolos e doces</div>
    <div id="bolos" class="grid hidden">
      <div class="item"><div class="item-name">Bolo simples</div><div class="item-price">R$ 3,00</div></div>
      <div class="item"><div class="item-name">Bolo com cobertura</div><div class="item-price">R$ 5,00</div></div>
      <div class="item"><div class="item-name">Bolo de chocolate</div><div class="item-price">R$ 5,00</div></div>
      <div class="item"><div class="item-name">Pudim</div><div class="item-price">R$ 4,00</div></div>
      <div class="item"><div class="item-name">Maçã do Amor</div><div class="item-price">R$ 5,00</div></div>
    </div>
  </section>

  <!-- ==================== SEÇÃO DE BEBIDAS ==================== -->
  <section>
    <div class="category-title" onclick="toggleGrid('bebidas')">Bebidas</div>
    <div id="bebidas" class="grid hidden">
      <div class="item"><div class="item-name">Refri. Guaraná 2L</div><div class="item-price">R$ 10,00</div></div>
      <div class="item"><div class="item-name">Coca-Cola 2L</div><div class="item-price">R$ 15,00</div></div>
      <div class="item"><div class="item-name">Coca-Cola 1L</div><div class="item-price">R$ 8,00</div></div>
      <div class="item"><div class="item-name">Fanta Uva 2L</div><div class="item-price">R$ 12,00</div></div>
      <div class="item"><div class="item-name">Fanta Laranja 2L</div><div class="item-price">R$ 12,00</div></div>
      <div class="item"><div class="item-name">Fanta Laranja 1L</div><div class="item-price">R$ 6,00</div></div>
      <div class="item"><div class="item-name">Água</div><div class="item-price">R$ 3,00</div></div>
    </div>
  </section>

  <!-- ==================== RODAPÉ COM BOTÃO DO CARRINHO ==================== -->
  <footer class="footer-fixo">
    <button class="botao-carrinho" onclick="mostrarResumo()"><img class="icone-car" src="img/icone_car.svg" alt="Carrinho" /> Carrinho</button>
  </footer>
  <!-- ==================== POP-UP DE QUANTIDADE ==================== -->
  <div id="popup" class="popup">
    <div class="popup-conteudo">
      <h2 id="popup-title">Inserir quant.</h2>
      <input class="in-quant" type="number" id="popup-input" placeholder="Qtd" min="1" />

      <div class="botoes">
        <button class="cancelar" onclick="fecharPopup()">Voltar</button>
        <button class="confirmar" onclick="confirmarPopup()">Inserir</button>
      </div>
    </div>
  </div>
 
<!-- ==================== POP-UP DE RESUMO DO PEDIDO ==================== -->
<div id="resumo-pedido" class="popup">
  <div class="popup-conteudo" style="max-height: 80vh; overflow-y: auto;">
    <h2>Resumo do Pedido</h2>
    <div id="lista-pedido" style="text-align: left; font-size: 1rem; margin-bottom: 1rem;"></div>
    <div class="botoes">
      <button href="#" class="cancelar" onclick="fecharResumo()">Voltar</button>
      <button href="#" class="confirmar" onclick="abrirPagamento()">Dinheiro</button>
      <button href="#" class="confirmar" onclick="abrirqrcode()">Pix</button>
    </div>
  </div>
</div>

<!-- ==================== POP-UP DE PAGAMENTO ==================== -->
<div id="pagamento" class="popup">
  <div class="popup-conteudo" style="max-height: 85vh; overflow-y: auto;">
    <h2>Concluir Pagamento</h2>
    <div id="pagamento-itens" style="text-align: left; font-size: 1rem; margin-bottom: 1rem;"></div>
    <label for="valor-dinheiro" style="font-size: 1.3rem;">Valor em dinheiro:</label>
    <input class="in-dinheiro" type="number" id="valor-dinheiro" min="0" oninput="calcularTroco()" placeholder="R$ 0,00"/>
    <p id="valor-troco" class="valor-troco"></p>
    <div class="botoes">
      <button href="#" class="cancelar" onclick="fecharPagamento()">Voltar</button>
      <button href="#" class="confirmar" onclick="concluirPedido()">Finalizar</button>
    </div>
  </div>
</div>

<!-- ==================== POP-UP MENSAGEM FINAL ==================== -->
<div id="mensagem-final" class="popup">
  <div class="popup-conteudo mensagem">
    <h2>✅ Pedido concluído com sucesso!</h2>
    <p>Imprima o recibo e entregue ao cliente.</p>
  </div>
</div>

<!-- ==================== POP-UP DE ALERTA (CARRINHO VAZIO) ==================== -->
<div id="popup-alerta-carrinho" class="popup">
  <div class="popup-carVazio">
    <div class="alerta-icone"><img src="img/icone_alerta.svg" alt="Alerta" /></div>
    <h2>Aviso</h2>
    <p>Seu carrinho está vazio.</p>
    <button class="cancelar" onclick="fecharPopupAlerta()">Fechar</button>
  </div>
</div>
  
<!-- ==================== POP-UP DE ALERTA (PAGAMENTO VAZIO) ==================== -->
<div id="popup-alerta-pagamento" class="popup">
  <div class="popup-carVazio">
    <div class="alerta-icone"><img src="img/icone_alerta.svg" alt="Alerta" /></div>
    <h2>Aviso</h2>
    <p>Inserir valor de pagamento.</p>
    <button class="cancelar" onclick="fecharPopuppagamento()">Fechar</button>
  </div>
</div>
  
  <!-- ==================== POP-UP PIX ==================== -->
<div id="popup-pix" class="popup">
  <div class="popup-conteudo">
    <h2>Pagamento via PIX</h2>
    <p>Escaneie o QR Code abaixo para pagar:</p>
    
    <!-- Imagem do QR Code -->
    <img src="img/vatapa.png" 
         alt="QRCode PIX" 
         style="width:220px; height:auto; margin:1rem auto; display:block; border:2px solid #555; border-radius:10px;">

  <p>Chave PIX: <strong>00990804275</strong></p>
<p id="valor-total-pix" style="font-size:1.2rem; font-weight:bold; color:#2c3e50; margin-top:0.5rem;">
  Inserir este valor no seu App: R$ 0,00
</p>

    <div class="botoes">
      <button class="cancelar" onclick="fecharPix()">Voltar</button>
      <button class="confirmar" onclick="concluirPedidoPix()">Finalizar</button>
    </div>
  </div>
</div>
  <script>
    /* ==================== VARIÁVEIS GLOBAIS ==================== */
    let carrinho = []; // lista de itens do carrinho
    const popup = document.getElementById('popup');
    const popupTitle = document.getElementById('popup-title');
    const popupInput = document.getElementById('popup-input');
    let itemSelecionado = null; // item clicado no cardápio

    /* ==================== EVENTO: CLICK EM CADA ITEM ==================== */
    document.querySelectorAll('.item').forEach(item => {
      item.addEventListener('click', () => {
        itemSelecionado = item;
        const nome = item.querySelector('.item-name')?.innerText || "Produto";
        popupTitle.textContent = `Inserir ${nome}`;
        popupInput.value = 1;
        popup.style.display = 'flex';
        popupInput.focus();
      });
    });

    /* ==================== CONFIRMA A QUANTIDADE NO POPUP ==================== */
    function confirmarPopup() {
      const qtd = parseInt(popupInput.value);
      if (isNaN(qtd) || qtd < 1) {
        alert('Digite uma quantidade válida.');
        popupInput.focus();
        return;
      }

      // Extrai dados do item selecionado
      const nome = itemSelecionado?.querySelector('.item-name')?.innerText || 'Produto';
      const precoText = itemSelecionado?.querySelector('.item-price')?.innerText || 'R$ 0,00';
      const preco = parseFloat(precoText.replace('R$', '').replace(',', '.'));

      // Se item já existe no carrinho, soma; caso contrário adiciona
      const existente = carrinho.find(item => item.nome === nome);
      if (existente) {
        existente.qtd += qtd;
      } else {
        carrinho.push({ nome, qtd, preco });
      }

      atualizarCarrinho();
      popup.style.display = 'none';

        const botaoCarrinho = document.querySelector('.botao-carrinho');
        const textoOriginal = botaoCarrinho.textContent;
        botaoCarrinho.textContent = '✔ Item adicionado!';
        botaoCarrinho.disabled = true;

        setTimeout(() => {
        botaoCarrinho.textContent = textoOriginal;
        botaoCarrinho.disabled = false;
      }, 1500);

  // Limpa input para próxima vez
  popupInput.value = 1;
    }

    /* ==================== ATUALIZA O BOTÃO DO CARRINHO ==================== */
    function atualizarCarrinho() {
      let total = carrinho.reduce((soma, item) => soma + item.qtd * item.preco, 0);
      const botao = document.querySelector('.botao-carrinho');
      botao.innerHTML = `<img class="icone-car" src="img/icone_car.svg" alt="Carrinho"> Total: R$ ${total.toFixed(2).replace('.', ',')}`;
    }

    /* ==================== FUNÇÕES DE FECHAR POPUPS ==================== */
    function fecharPopup() { popup.style.display = 'none'; }
    function fecharResumo() { document.getElementById('resumo-pedido').style.display = 'none'; }
    function fecharPagamento() { document.getElementById('pagamento').style.display = 'none'; }

    /* ==================== MOSTRAR RESUMO DO PEDIDO ==================== */
    function mostrarResumo() {
      if (carrinho.length === 0) {
    mostrarPopupAlerta(); // Mostra o novo popup
    return;
  }

      const lista = document.getElementById('lista-pedido');
      lista.innerHTML = "";
      let total = 0;

      carrinho.forEach((item, index) => {
        const subtotal = item.qtd * item.preco;
        total += subtotal;
        lista.innerHTML += `
          <p>
            <strong>${item.qtd}x</strong> ${item.nome} - R$ ${item.preco.toFixed(2).replace('.', ',')} 
            <br><small class="subtotal">Subtotal: R$ ${subtotal.toFixed(2).replace('.', ',')}</small>
            <br>
            <button class="remover-item" onclick="removerItem(${index})">Remover</button>
          </p>
          <hr/>
        `;
      });

      lista.innerHTML += `<p class="tt-liquido">Total líquido:<strong> R$ ${total.toFixed(2).replace('.', ',')}</strong></p>`;
      document.getElementById('resumo-pedido').style.display = 'flex';
    }

    /* ==================== REMOVER ITEM DO CARRINHO ==================== */
    function removerItem(index) {
      if (index > -1 && index < carrinho.length) {
        carrinho.splice(index, 1);
        mostrarResumo();
        atualizarCarrinho();
      }
    }

    /* ==================== TROCA ENTRE CATEGORIAS (PRATOS, BEBIDAS, ETC.) ==================== */
    function toggleGrid(id) {
      const grids = document.querySelectorAll('.grid');
      grids.forEach(grid => {
        grid.id === id ? grid.classList.remove('hidden') : grid.classList.add('hidden');
      });
    }

    /* ==================== ABRE TELA DE PAGAMENTO ==================== */
    function abrirPagamento() {
      const divItens = document.getElementById('pagamento-itens');
      divItens.innerHTML = "";
      let total = 0;

      carrinho.forEach(item => {
        const subtotal = item.qtd * item.preco;
        total += subtotal;
        divItens.innerHTML += `
          <p><strong>${item.qtd}x</strong> ${item.nome} - R$ ${item.preco.toFixed(2).replace('.', ',')}
          <br><small>Subtotal: R$ ${subtotal.toFixed(2).replace('.', ',')}</small></p><hr/>
        `;
      });

      divItens.innerHTML += `<p class="tt-liquido">Total líquido:<strong> R$ ${total.toFixed(2).replace('.', ',')}</strong></p>`;
      document.getElementById("valor-dinheiro").value = "";
      document.getElementById("valor-troco").textContent = "";
      document.getElementById('pagamento').style.display = 'flex';
    }

    /* ==================== CALCULAR TROCO ==================== */
    function calcularTroco() {
      const valor = parseFloat(document.getElementById("valor-dinheiro").value);
      let total = carrinho.reduce((soma, item) => soma + item.qtd * item.preco, 0);

      if (!isNaN(valor)) {
        let troco = valor - total;
        let trocoTexto = troco >= 0 
          ? `Troco: R$ ${troco.toFixed(2).replace('.', ',')}` 
          : `Falta: R$ ${(troco * -1).toFixed(2).replace('.', ',')}`;
        document.getElementById("valor-troco").textContent = trocoTexto;
      } else {
        document.getElementById("valor-troco").textContent = "";
      }
    }

    /* ==================== CONCLUIR PEDIDO ==================== */
    function concluirPedido() {
      const valor = parseFloat(document.getElementById("valor-dinheiro").value);
      let total = carrinho.reduce((soma, item) => soma + item.qtd * item.preco, 0);

      if (isNaN(valor)) {
        document.getElementById("popup-alerta-pagamento").style.display = "flex";
        // alert("Por favor, informe o valor em dinheiro.");
        document.getElementById("valor-dinheiro").focus();
        return;
      }

      if (valor < total) {
        const falta = (total - valor).toFixed(2).replace('.', ',');
        alert(`O valor informado é insuficiente. Ainda faltam R$ ${falta}.`);
        document.getElementById("valor-dinheiro").focus();
        return;
      }

      // Mostra a mensagem final
      document.getElementById("mensagem-final").style.display = "flex";

      // Fecha e reinicia após 2 segundos
      setTimeout(() => {
        fecharMensagemFinal();
      }, 2000);
    }

    /* ==================== RESETAR APÓS FINALIZAÇÃO ==================== */
    function fecharMensagemFinal() {
      carrinho = []; 
      atualizarCarrinho(); 
      document.getElementById("mensagem-final").style.display = "none";
      fecharPopup();
      fecharResumo();
      fecharPagamento();
    }

	// Função para mostrar o popup de alerta
	function mostrarPopupAlerta() {
		document.getElementById('popup-alerta-carrinho').style.display = 'flex';
	}

// Função para fechar o popup de alerta
function fecharPopupAlerta() {
  document.getElementById('popup-alerta-carrinho').style.display = 'none';
}

  function fecharPopuppagamento() {
    document.getElementById('popup-alerta-pagamento').style.display = 'none';
  }
  function abrirqrcode() {
  // Calcula o total do carrinho
  let total = carrinho.reduce((soma, item) => soma + item.qtd * item.preco, 0);

  // Atualiza o texto do valor total no popup PIX
  const valorPix = document.getElementById("valor-total-pix");
  valorPix.innerHTML = `<p class="tt-liquido">Inserir <strong> R$ ${total.toFixed(2).replace('.', ',')}</strong> no seu <b>App de Pagamentos.</b></p>`;

  // Exibe o popup PIX
  document.getElementById("popup-pix").style.display = "flex";
}

function fecharPix() {
  document.getElementById("popup-pix").style.display = "none";
}
  function concluirPedidoPix() {
  // Exibe a mensagem de sucesso
  document.getElementById("mensagem-final").style.display = "flex";

  // Fecha e reseta tudo após 2 segundos
  setTimeout(() => {
    fecharMensagemFinal(); // reutiliza a função já existente
    fecharPix();           // fecha o popup PIX
  }, 2000);
}
    /* ==================== ATALHOS DE TECLADO ==================== */
    popup.addEventListener('click', (e) => { if (e.target === popup) fecharPopup(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') fecharPopup(); });
  </script>
  
</body>
</html>
